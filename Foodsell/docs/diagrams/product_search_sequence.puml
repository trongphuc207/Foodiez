@startuml
title Product Search Flow
skinparam monochrome true
skinparam sequenceArrowThickness 1
skinparam sequenceParticipant underline
actor User
participant "React App" as FE
participant "Product API
(ProductController)" as API
participant "ProductService" as SVC
participant "ProductRepository" as REPO
database DB

User -> FE : Nhập từ khóa tìm kiếm
FE -> API : GET /api/products/search?keyword=...
activate API
API -> SVC : searchProducts(keyword)
activate SVC
SVC -> REPO : findByNameContainingIgnoreCase(keyword)
activate REPO
REPO -> DB : Query by name (case-insensitive)
DB --> REPO : List<Product> results1
deactivate REPO
alt results1 trống
SVC -> REPO : searchProducts(keyword)
activate REPO
note right of REPO: SELECT p FROM Product p WHERE \" + \"LOWER(p.name) LIKE LOWER(CONCAT('%', :keyword, '%')) OR \" + \"LOWER(p.description) LIKE LOWER(CONCAT('%', :keyword, '%'))
DB --> REPO : List<Product> results2
deactivate REPO
end
SVC --> API : List<Product>
deactivate SVC
API --> FE : 200 OK + JSON
deactivate API
FE --> User : Hiển thị danh sách sản phẩm
note over FE,API #DDFFDD
 Frontend fetch: 
 GET /products/search?keyword={keyword}
end note
@enduml